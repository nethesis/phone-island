{"version":3,"file":"audio.js","sources":["../../../src/lib/player/audio.ts"],"sourcesContent":["// Copyright (C) 2024 Nethesis S.r.l.\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { getAnnouncement, getAllAnnouncementsInfo } from '../../services/offhour'\nimport { getCallRecording, getRecordingFileName } from '../../services/history_call'\nimport { store } from '../../store'\nimport { AnnouncementInfoTypes } from '../../types'\nimport { getVoicemailBase64, getVoicemailFileName } from '../../services/voicemail'\n\n/**\n * Given an id plays an announcement\n */\nexport async function playAnnouncement(id: string) {\n  if (id) {\n    const audioFile: string = await getAnnouncement(id)\n    if (audioFile) {\n      store.dispatch.island.setIslandView('player')\n      store.dispatch.player.setAudioPlayerType('announcement')\n      store.dispatch.player.updateStartAudioPlayer({\n        src: audioFile,\n      })\n    }\n  }\n}\n\n/**\n * Given an id plays a call recording\n */\nexport async function playCallRecording(id: string) {\n  if (id) {\n    const audioFile: string = await getCallRecording(id)\n    if (audioFile) {\n      store.dispatch.island.setIslandView('player')\n      store.dispatch.player.setAudioPlayerType('call_recording')\n      store.dispatch.player.updateStartAudioPlayer({\n        src: audioFile,\n      })\n    }\n  }\n}\n\n/**\n * Given an id plays a call recording\n */\nexport async function playVoicemail(id: string) {\n  if (id) {\n    const audioFile: string = await getVoicemailBase64(id)\n    if (audioFile) {\n      store.dispatch.island.setIslandView('player')\n      store.dispatch.player.setAudioPlayerType('voicemail')\n      store.dispatch.player.updateStartAudioPlayer({\n        src: audioFile,\n      })\n    }\n  }\n}\n\n/**\n * Given an id retrieves the name of the call recording\n */\nexport async function getRecordingName(id: string) {\n  if (id) {\n    const fileName: string = await getRecordingFileName(id)\n    if (fileName) {\n      store.dispatch.player.setAudioPlayerTrackName(fileName)\n    }\n  }\n}\n\n/**\n * Given an id retrieves the name of the call recording\n */\nexport async function getAnnouncementName(id: string) {\n  if (id) {\n    const allAnnouncements: AnnouncementInfoTypes[] = await getAllAnnouncementsInfo()\n    const announcement = allAnnouncements.find((announcement) => announcement.id.toString() === id)\n    if (announcement?.description) {\n      store.dispatch.player.setAudioPlayerTrackName(announcement.description)\n    }\n  }\n}\n\nexport async function getVoicemailName(id: string) {\n  if (id) {\n    const fileName: string = await getVoicemailFileName(id)\n\n    if (fileName) {\n      store.dispatch.player.setAudioPlayerTrackName(fileName)\n    }\n  }\n}\n"],"names":["id","getAllAnnouncementsInfo","allAnnouncements","_a","sent","announcement","find","toString","description","store","dispatch","player","setAudioPlayerTrackName","getRecordingFileName","fileName","getVoicemailFileName","getAnnouncement","audioFile","island","setIslandView","setAudioPlayerType","updateStartAudioPlayer","src","getCallRecording","getVoicemailBase64"],"mappings":"qTAwEM,SAAoCA,2HACpC,OAAAA,EACsD,CAAA,EAAAC,EAAuBA,2BAD3E,CAAA,EAAA,UACEC,EAA4CC,EAA+BC,QAE7EC,OADEA,EAAeH,EAAiBI,MAAK,SAACD,GAAiB,OAAAA,EAAaL,GAAGO,aAAeP,CAAE,YAC1FK,EAAcG,cAChBC,EAAKA,MAACC,SAASC,OAAOC,wBAAwBP,EAAaG,8CAGhE,2BApBK,SAAiCR,yHACjC,OAAAA,EACuB,CAAA,EAAMa,uBAAqBb,IADhD,CAAA,EAAA,WACEc,EAAmBX,EAA8BC,SAErDK,EAAAA,MAAMC,SAASC,OAAOC,wBAAwBE,oCAGnD,2BAeK,SAAiCd,yHACjC,OAAAA,EACuB,CAAA,EAAMe,uBAAqBf,IADhD,CAAA,EAAA,WACEc,EAAmBX,EAA8BC,SAGrDK,EAAAA,MAAMC,SAASC,OAAOC,wBAAwBE,oCAGnD,2BA9EK,SAAiCd,yHACjC,OAAAA,EACwB,CAAA,EAAMgB,kBAAgBhB,IAD5C,CAAA,EAAA,WACEiB,EAAoBd,EAAyBC,UAEjDK,EAAAA,MAAMC,SAASQ,OAAOC,cAAc,UACpCV,EAAAA,MAAMC,SAASC,OAAOS,mBAAmB,gBACzCX,QAAMC,SAASC,OAAOU,uBAAuB,CAC3CC,IAAKL,sCAIZ,4BAKK,SAAkCjB,yHAClC,OAAAA,EACwB,CAAA,EAAMuB,mBAAiBvB,IAD7C,CAAA,EAAA,WACEiB,EAAoBd,EAA0BC,UAElDK,EAAAA,MAAMC,SAASQ,OAAOC,cAAc,UACpCV,EAAAA,MAAMC,SAASC,OAAOS,mBAAmB,kBACzCX,QAAMC,SAASC,OAAOU,uBAAuB,CAC3CC,IAAKL,sCAIZ,wBAKK,SAA8BjB,yHAC9B,OAAAA,EACwB,CAAA,EAAMwB,qBAAmBxB,IAD/C,CAAA,EAAA,WACEiB,EAAoBd,EAA4BC,UAEpDK,EAAAA,MAAMC,SAASQ,OAAOC,cAAc,UACpCV,EAAAA,MAAMC,SAASC,OAAOS,mBAAmB,aACzCX,QAAMC,SAASC,OAAOU,uBAAuB,CAC3CC,IAAKL,sCAIZ"}
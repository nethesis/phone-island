"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../node_modules/tslib/tslib.es6.js"),t=require("react");require("../../node_modules/react-redux/es/index.js");var i=require("../../node_modules/@fortawesome/react-fontawesome/index.es.js"),l=require("../../node_modules/@fortawesome/free-solid-svg-icons/index.mjs.js"),n=require("../Button.js"),r=require("../../utils/genericFunctions/isEmpty.js"),a=require("../../lib/phone/call.js"),o=require("../../node_modules/@nethesis/nethesis-solid-svg-icons/index.mjs.js"),s=require("../../utils/genericFunctions/eventDispatch.js");require("../../store/index.js");var d=require("../../services/user.js"),u=require("../CustomThemedTooltip.js");require("../../node_modules/@babel/runtime/helpers/defineProperty.js"),require("../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),require("../../node_modules/@babel/runtime/helpers/typeof.js"),require("../../node_modules/html-parse-stringify/dist/html-parse-stringify.js"),require("../../node_modules/react-i18next/dist/es/context.js");var c=require("../../node_modules/react-i18next/dist/es/useTranslation.js");require("../../node_modules/@babel/runtime/helpers/slicedToArray.js");var p=require("../../utils/deviceUtils.js"),m=require("../../node_modules/react-redux/es/hooks/useDispatch.js"),f=require("../../node_modules/react-redux/es/hooks/useSelector.js");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=v(t);exports.SwitchDeviceView=function(){var v=m.useDispatch(),y=c.useTranslation().t,b=f.useSelector((function(e){return null==e?void 0:e.currentUser})),g=f.useSelector((function(e){return null==e?void 0:e.users})),x=Object.keys((null==b?void 0:b.conversations)||{}).filter((function(e){return!r.isEmpty(b.conversations[e])})),w=p.getAvailableDevices(b,g),j=t.useState(null),k=j[0],E=j[1],q=t.useState({id:"",type:""}),_=q[0],N=q[1],D=x[0],S=function(t){var i,l,n,r;(null==_?void 0:_.id)&&t&&("physical"==(null==_?void 0:_.type)&&"physical"===(null===(i=null==b?void 0:b.default_device)||void 0===i?void 0:i.type)?(v.island.toggleAvoidToShow(!1),a.blindTransferFunction(null==_?void 0:_.id,t),s.eventDispatch("phone-island-call-switched",{})):"physical"===(null==_?void 0:_.type)&&"nethlink"===(null===(l=null==b?void 0:b.default_device)||void 0===l?void 0:l.type)?(v.island.toggleAvoidToShow(!1),r=_,e.__awaiter(void 0,void 0,void 0,(function(){var t,i;return e.__generator(this,(function(e){switch(e.label){case 0:if(t={},!r)return[3,4];t.id=null==r?void 0:r.id,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,d.changeDefaultDevice(t)];case 2:return e.sent(),v.user.updateDefaultDevice(r),[3,4];case 3:return i=e.sent(),console.log(i),[3,4];case 4:return[2]}}))})),v.currentUser.updateCurrentDefaultDevice(_),s.eventDispatch("phone-island-default-device-changed",{}),setTimeout((function(){a.blindTransferFunction(null==_?void 0:_.id,t),s.eventDispatch("phone-island-call-switched",{})}),500),s.eventDispatch("phone-island-call-switched",{})):("mobile"===(null==_?void 0:_.type)||"physical"===(null==_?void 0:_.type)&&"nethlink"!==(null===(n=null==b?void 0:b.default_device)||void 0===n?void 0:n.type))&&(v.island.toggleAvoidToShow(!0),a.blindTransferFunction(null==_?void 0:_.id,t),s.eventDispatch("phone-island-call-switched",{})))};return h.default.createElement(h.default.Fragment,null,h.default.createElement("div",{className:"pi-flex pi-flex-col pi-w-full"},h.default.createElement("div",{className:"pi-flex pi-items-center pi-justify-between"},h.default.createElement("div",{className:"pi-flex pi-items-center pi-space-x-2"},h.default.createElement("h1",{className:"pi-flex pi-text-lg pi-font-medium pi-text-gray-900 dark:pi-text-gray-50"},y("Switch device.Switch device")||""),h.default.createElement(i.FontAwesomeIcon,{icon:l.faCircleInfo,className:"pi-flex pi-w-4 pi-h-4 pi-text-indigo-800 dark:pi-text-indigo-300","data-tooltip-id":"tooltip-switch-information","data-tooltip-content":y("Switch device.Switch information")||""})),h.default.createElement(n.Button,{onClick:function(){return v.island.setIslandView("call")},variant:"transparentSettings","data-tooltip-id":"tooltip-close-settings","data-tooltip-content":y("Common.Close")||""},h.default.createElement(i.FontAwesomeIcon,{icon:l.faXmark,className:"pi-w-5 pi-h-5"}))),h.default.createElement("div",{className:"pi-border-t pi-border-gray-300 dark:pi-border-gray-600 pi-mt-1"}),h.default.createElement("div",{className:"pi-flex pi-flex-col pi-mt-2 pi-h-40 pi-overflow-y-auto pi-space-y-2 pi-scrollbar-thin pi-scrollbar-thumb-gray-400 pi-dark:scrollbar-thumb-gray-400 pi-scrollbar-thumb-rounded-full pi-scrollbar-thumb-opacity-50 dark:pi-scrollbar-track-gray-900 pi-scrollbar-track-gray-200 pi-dark:scrollbar-track-gray-900 pi-scrollbar-track-rounded-full pi-scrollbar-track-opacity-25"},w.map((function(e){return h.default.createElement("div",{key:null==e?void 0:e.id,className:"pi-flex pi-items-center pi-justify-between pi-px-4 pi-py-3 pi-text-base pi-font-normal pi-leading-6 dark:pi-text-gray-200 pi-text-gray-700 hover:pi-bg-gray-200 dark:hover:pi-bg-gray-700 dark:pi-bg-gray-950 pi-bg-gray-50 pi-rounded-md",onClick:function(){return function(e){N({id:null==e?void 0:e.id,type:null==e?void 0:e.type})}(e)},onMouseEnter:function(){return E(null==e?void 0:e.id)},onMouseLeave:function(){return E(null)}},h.default.createElement("div",{className:"pi-flex pi-items-center pi-max-w-60 pi-truncate"},h.default.createElement(i.FontAwesomeIcon,{icon:"mobile"===(null==e?void 0:e.type)?l.faMobile:"physical"===(null==e?void 0:e.type)?o.faOfficePhone:l.faUser,className:"pi-mr-2 pi-w-5 pi-h-5"}),h.default.createElement("span",{className:"pi-truncate"},"mobile"===(null==e?void 0:e.type)?y("Phone Island.Mobile app"):"physical"===(null==e?void 0:e.type)?null==e?void 0:e.description:"-")),h.default.createElement("div",{className:"pi-flex pi-items-center"},_.id===(null==e?void 0:e.id)&&h.default.createElement(i.FontAwesomeIcon,{icon:l.faCheck,className:"".concat(k===(null==e?void 0:e.id)?"pi-text-gray-700 dark:pi-text-gray-200":"pi-text-emerald-700 dark:pi-text-emerald-500"," pi-w-5 pi-h-5")})))}))),h.default.createElement("div",{className:"pi-flex pi-justify-center pi-mt-2"},h.default.createElement(n.Button,{disabled:""===(null==_?void 0:_.id),variant:"gray",className:"pi-font-medium pi-text-sm pi-leading-5",onClick:function(){return S(D)}},h.default.createElement(i.FontAwesomeIcon,{className:"pi-w-6 pi-h-6 pi-mr-2",icon:o.faArrowsRepeat}),h.default.createElement("span",null,y("Switch device.Switch device"))))),h.default.createElement(u.CustomThemedTooltip,{id:"tooltip-close-settings",place:"bottom"}),h.default.createElement(u.CustomThemedTooltip,{id:"tooltip-switch-information",place:"bottom"}))};
//# sourceMappingURL=index.js.map

{"version":3,"file":"AvatarGroup.js","sources":["../../src/components/AvatarGroup.tsx"],"sourcesContent":["// Copyright (C) 2024 Nethesis S.r.l.\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport React, { FC } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus } from '@fortawesome/free-solid-svg-icons'\nimport { useSelector } from 'react-redux'\nimport { RootState } from '../store'\n\nexport interface AvatarGroupProps {\n  usersList: Record<string, any> | null | undefined\n  maxAvatars?: number\n}\n\n/**\n * Display a group of user avatars with a \"+\" indicator for additional users\n */\nconst AvatarGroup: FC<AvatarGroupProps> = ({ usersList, maxAvatars = 5 }) => {\n  const { avatars } = useSelector((state: RootState) => state.avatars)\n  const { extensions } = useSelector((state: RootState) => state.users)\n  const { name } = useSelector((state: RootState) => state.currentUser)\n\n  // Filter out current user and convert to array\n  const users = usersList ? Object.values(usersList).filter((user: any) => user?.name !== name) : []\n  const totalUsers = users.length\n  const displayUsers = users.slice(0, maxAvatars)\n\n  // Get user avatar URL\n  const getAvatarUrl = (username: string | undefined): string | null => {\n    if (!username || !avatars) return null\n\n    // Try through extensions\n    if (extensions && extensions[username]?.username && avatars[extensions[username].username]) {\n      return `${avatars[extensions[username].username]}`\n    }\n\n    return null\n  }\n\n  // Helper function to generate initials from name\n  const generateInitials = (name: string | undefined, username: string | undefined): string => {\n    if (name) {\n      return name\n        .split(' ')\n        .map((n: string) => n[0])\n        .join('')\n        .toUpperCase()\n        .slice(0, 2)\n    } else if (username) {\n      return username.substring(0, 2).toUpperCase()\n    }\n    return '??'\n  }\n\n  return (\n    <div className='pi-flex pi-items-center pi-overflow-hidden pi--space-x-1'>\n      {displayUsers.map((user: any, index) => {\n        const username = user?.extenId || user?.id\n        const avatarUrl = getAvatarUrl(username)\n        const initials = generateInitials(user?.name, username)\n\n        return (\n          <div\n            key={index}\n            className='pi-inline-flex pi-items-center pi-justify-center pi-w-6 pi-h-6 pi-rounded-full pi-ring-2 pi-bg-gray-200 pi-ring-gray-700'\n          >\n            {avatarUrl ? (\n              <div\n                className='pi-rounded-full pi-w-6 pi-h-6'\n                style={{\n                  backgroundImage: `url(${avatarUrl})`,\n                  backgroundRepeat: 'no-repeat',\n                  backgroundSize: 'contain',\n                  backgroundPosition: 'center',\n                  width: '100%',\n                  height: '100%',\n                }}\n              />\n            ) : (\n              <span className='pi-text-xs pi-font-medium pi-text-gray-900'>{initials}</span>\n            )}\n          </div>\n        )\n      })}\n\n      {totalUsers > maxAvatars && (\n        <span className='pi-inline-flex pi-items-center pi-justify-center pi-w-6 pi-h-6 pi-rounded-full pi-bg-gray-200 pi-ring-2 pi-ring-gray-700'>\n          <FontAwesomeIcon icon={faPlus} className='pi-text-xs pi-text-gray-900' />\n        </span>\n      )}\n    </div>\n  )\n}\n\nexport default AvatarGroup\n"],"names":["_a","usersList","_b","maxAvatars","avatars","useSelector","state","extensions","users","name","currentUser","Object","values","filter","user","totalUsers","length","displayUsers","slice","React","createElement","className","map","index","username","extenId","id","avatarUrl","concat","getAvatarUrl","initials","split","n","join","toUpperCase","substring","generateInitials","key","style","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","width","height","FontAwesomeIcon","icon","faPlus"],"mappings":"0cAiB0C,SAACA,GAAE,IAAAC,cAAWC,EAAAF,EAAAG,WAAAA,OAAU,IAAAD,EAAG,EAACA,EAC5DE,EAAYC,eAAY,SAACC,GAAqB,OAAAA,EAAMF,mBACpDG,EAAeF,eAAY,SAACC,GAAqB,OAAAA,EAAME,oBACvDC,EAASJ,eAAY,SAACC,GAAqB,OAAAA,EAAMI,oBAGnDF,EAAQP,EAAYU,OAAOC,OAAOX,GAAWY,QAAO,SAACC,GAAc,OAAAA,aAAA,EAAAA,EAAML,QAASA,KAAQ,GAC1FM,EAAaP,EAAMQ,OACnBC,EAAeT,EAAMU,MAAM,EAAGf,GA6BpC,OACEgB,EAAA,QAAAC,cAAA,MAAA,CAAKC,UAAU,4DACZJ,EAAaK,KAAI,SAACR,EAAWS,GAC5B,IAAMC,GAAWV,eAAAA,EAAMW,WAAWX,aAAI,EAAJA,EAAMY,IAClCC,EA9BS,SAACH,SACpB,OAAKA,GAAapB,GAGdG,YAAcP,EAAAO,EAAWiB,yBAAWA,WAAYpB,EAAQG,EAAWiB,GAAUA,UACxE,GAAAI,OAAGxB,EAAQG,EAAWiB,GAAUA,WAJP,IAQpC,CAqBwBK,CAAaL,GACzBM,EAnBa,SAACrB,EAA0Be,GAClD,OAAIf,EACKA,EACJsB,MAAM,KACNT,KAAI,SAACU,GAAc,OAAAA,EAAE,MACrBC,KAAK,IACLC,cACAhB,MAAM,EAAG,GACHM,EACFA,EAASW,UAAU,EAAG,GAAGD,cAE3B,IACT,CAOuBE,CAAiBtB,aAAA,EAAAA,EAAML,KAAMe,GAE9C,OACEL,EAAAA,6BACEkB,IAAKd,EACLF,UAAU,4HAETM,EACCR,EAAA,QAAAC,cAAA,MAAA,CACEC,UAAU,gCACViB,MAAO,CACLC,gBAAiB,OAAOX,OAAAD,EAAY,KACpCa,iBAAkB,YAClBC,eAAgB,UAChBC,mBAAoB,SACpBC,MAAO,OACPC,OAAQ,UAIZzB,UAAMC,cAAA,OAAA,CAAAC,UAAU,8CAA8CS,GAItE,IAECf,EAAaZ,GACZgB,UAAMC,cAAA,OAAA,CAAAC,UAAU,4HACdF,UAAAC,cAACyB,EAAeA,gBAAA,CAACC,KAAMC,SAAQ1B,UAAU,iCAKnD"}
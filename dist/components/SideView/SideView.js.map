{"version":3,"file":"SideView.js","sources":["../../../src/components/SideView/SideView.tsx"],"sourcesContent":["import React, { FC, useCallback, useMemo, memo, useEffect, useState } from 'react'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { RootState } from '../../store'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport {\n  faArrowUpRightFromSquare,\n  faDisplay,\n  faStop,\n  faVideo,\n  faVideoSlash,\n} from '@fortawesome/free-solid-svg-icons'\nimport { faArrowsRepeat, faRecord } from '@nethesis/nethesis-solid-svg-icons'\nimport { useTranslation } from 'react-i18next'\nimport { recordCurrentCall } from '../../lib/phone/call'\nimport { CustomThemedTooltip } from '../CustomThemedTooltip'\nimport { useSideViewLogic } from './hooks/useSideViewLogic'\nimport { SideViewButton } from './components/SideViewButton'\n\nconst ANIMATION_CONFIG = {\n  initial: { x: -76 },\n  animate: { x: 4, transition: { duration: 0.1, ease: 'easeOut' } },\n  exit: { x: -76, transition: { duration: 0.1, ease: 'easeIn' } },\n} as const\n\nconst STYLE_CONFIG = {\n  borderTopRightRadius: '20px',\n  borderBottomRightRadius: '20px',\n  width: '80px',\n  transformOrigin: 'right',\n} as const\n\ninterface ButtonConfig {\n  active?: boolean\n  onClick: () => void | Promise<void>\n  tooltipId: string\n  tooltipContent: string\n  icon: any\n  disabled?: boolean\n}\n\ninterface ButtonConfigWithKey extends ButtonConfig {\n  key: string\n}\n\nconst SideView: FC<SideViewTypes> = memo(({ isVisible, uaType }) => {\n  const { isOpen } = useSelector((state: RootState) => state.island)\n  const { isRecording } = useSelector((state: RootState) => state.currentCall)\n  const { t } = useTranslation()\n\n  const {\n    videoInputDevices,\n    isVideoCallButtonVisible,\n    canRecord,\n    canShareScreen,\n    canSwitchDevice,\n    isUrlButtonEnabled,\n    hasValidUrl,\n    goToVideoCall,\n    goToScreenSharing,\n    closeSideViewAndLaunchEvent,\n  } = useSideViewLogic(uaType)\n\n  const handleRecordClick = useCallback(() => {\n    recordCurrentCall(isRecording)\n  }, [isRecording])\n\n  const buttonConfigs = useMemo(() => {\n    const configs: (ButtonConfigWithKey | false)[] = [\n      canRecord && {\n        key: 'record',\n        active: isRecording,\n        onClick: handleRecordClick,\n        tooltipId: 'tooltip-record',\n        tooltipContent: isRecording ? t('Tooltip.Stop recording') || '' : t('Tooltip.Record') || '',\n        icon: isRecording ? faStop : faRecord,\n      },\n      videoInputDevices?.length > 0 && {\n        key: 'video',\n        onClick: goToVideoCall,\n        tooltipId: 'tooltip-video',\n        tooltipContent: isVideoCallButtonVisible\n          ? t('Tooltip.Enable camera') || ''\n          : t('Tooltip.Enable camera permission') || '',\n        disabled: !isVideoCallButtonVisible,\n        icon: isVideoCallButtonVisible ? faVideo : faVideoSlash,\n      },\n      canShareScreen && {\n        key: 'screen-share',\n        onClick: goToScreenSharing,\n        tooltipId: 'tooltip-screen-share',\n        tooltipContent: t('Tooltip.Share screen') || '',\n        icon: faDisplay,\n      },\n      hasValidUrl &&\n      isUrlButtonEnabled && {\n        key: 'url',\n        onClick: () => closeSideViewAndLaunchEvent('openUrl'),\n        tooltipId: 'tooltip-open-url',\n        tooltipContent: t('Tooltip.Open url') || '',\n        icon: faArrowUpRightFromSquare,\n      },\n      canSwitchDevice && {\n        key: 'switch-device',\n        onClick: () => closeSideViewAndLaunchEvent('switchDevice'),\n        tooltipId: 'tooltip-switch-device',\n        tooltipContent: t('Tooltip.Switch device') || '',\n        icon: faArrowsRepeat,\n      },\n    ]\n\n    return configs.filter((config): config is ButtonConfigWithKey => Boolean(config))\n  }, [\n    canRecord,\n    isRecording,\n    handleRecordClick,\n    t,\n    videoInputDevices?.length,\n    goToVideoCall,\n    isVideoCallButtonVisible,\n    canShareScreen,\n    goToScreenSharing,\n    hasValidUrl,\n    isUrlButtonEnabled,\n    closeSideViewAndLaunchEvent,\n    canSwitchDevice,\n  ])\n\n  const containerClassName = useMemo(\n    () =>\n      `pi-absolute pi-h-full pi-bg-surfaceSidebar dark:pi-bg-surfaceSidebarDark pi-flex pi-flex-col pi-items-center pi-text-iconWhite dark:pi-text-iconWhiteDark -pi-mr-10 pi-right-0 -pi-z-10 pi-pointer-events-auto ${isOpen ? 'pi-py-6' : 'pi-py-4'\n      }`,\n    [isOpen],\n  )\n\n  return (\n    <>\n      <AnimatePresence>\n        {isVisible && (\n          <motion.div className={containerClassName} style={STYLE_CONFIG} {...ANIMATION_CONFIG}>\n            <div className='pi-flex pi-flex-col pi-items-center pi-gap-3.5 pi-flex-1 pi-ml-9'>\n              {buttonConfigs.map(({ key, ...config }) => (\n                <SideViewButton key={key} {...config} />\n              ))}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      <CustomThemedTooltip id='tooltip-record' place='left' />\n      <CustomThemedTooltip id='tooltip-video' place='left' />\n      <CustomThemedTooltip id='tooltip-screen-share' place='left' />\n      <CustomThemedTooltip id='tooltip-switch-device' place='left' />\n      <CustomThemedTooltip id='tooltip-open-url' place='left' />\n    </>\n  )\n})\n\nSideView.displayName = 'SideView'\n\nexport default SideView\n\ninterface SideViewTypes {\n  isVisible: boolean\n  uaType?: string\n}\n"],"names":["ANIMATION_CONFIG","initial","x","animate","transition","duration","ease","exit","STYLE_CONFIG","borderTopRightRadius","borderBottomRightRadius","width","transformOrigin","SideView","memo","_a","isVisible","uaType","isOpen","useSelector","state","island","isRecording","currentCall","t","useTranslation","_b","useSideViewLogic","videoInputDevices","isVideoCallButtonVisible","canRecord","canShareScreen","canSwitchDevice","isUrlButtonEnabled","hasValidUrl","goToVideoCall","goToScreenSharing","closeSideViewAndLaunchEvent","handleRecordClick","useCallback","recordCurrentCall","buttonConfigs","useMemo","key","active","onClick","tooltipId","tooltipContent","icon","faStop","faRecord","length","disabled","faVideo","faVideoSlash","faDisplay","faArrowUpRightFromSquare","faArrowsRepeat","filter","config","Boolean","containerClassName","concat","React","createElement","Fragment","AnimatePresence","motion","div","__assign","className","style","map","__rest","SideViewButton","CustomThemedTooltip","id","place","displayName"],"mappings":"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"}
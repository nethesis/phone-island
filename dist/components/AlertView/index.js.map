{"version":3,"file":"index.js","sources":["../../../src/components/AlertView/index.tsx"],"sourcesContent":["// Copyright (C) 2024 Nethesis S.r.l.\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport React, { FC } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Dispatch, RootState } from '../../store'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport {\n  faTimes,\n  faCircleXmark,\n  faCircleCheck,\n  faArrowRotateRight,\n} from '@fortawesome/free-solid-svg-icons'\nimport { Button } from '../Button'\nimport { t } from 'i18next'\nimport { eventDispatch } from '../../utils'\nimport { CustomThemedTooltip } from '../CustomThemedTooltip'\n\n/**\n * Shows user alerts\n */\nconst AlertView: FC<AlertViewProp> = ({ uaType }) => {\n  const { data } = useSelector((state: RootState) => state.alerts)\n  const { default_device } = useSelector((state: RootState) => state.currentUser)\n  const dispatch = useDispatch<Dispatch>()\n\n  // Extract active alerts\n  const activeAlerts = Object.values(data).filter((alert: any) => alert.active)\n\n  // Display the latest active alert\n  const latestAlert = activeAlerts.length > 0 ? activeAlerts[activeAlerts.length - 1] : null\n\n  const handleClearAllAlerts = () => {\n    dispatch.alerts.removeAllAlerts()\n    eventDispatch('phone-island-all-alerts-removed', {})\n  }\n\n  const reloadPhoneIsland = () => {\n    window.location.reload()\n  }\n\n  return (\n    latestAlert && (\n      <div className='pi-relative pi-rounded-md pi-w-full pi-flex'>\n        <div className='pi-flex pi-items-center'>\n          <div\n            className={`pi-flex pi-items-center pi-justify-center pi-flex-shrink-0 pi-mr-4 pi-rounded-full pi-h-10 pi-w-10 ${\n              latestAlert?.type === 'call_transfered'\n                ? 'pi-bg-green-200 dark:pi-bg-green-900'\n                : 'pi-bg-rose-200 dark:pi-bg-rose-900'\n            }`}\n          >\n            {/* Icon */}\n            <FontAwesomeIcon\n              icon={latestAlert?.type === 'call_transfered' ? faCircleCheck : faCircleXmark}\n              className={`pi-h-5 pi-w-10 ${\n                latestAlert?.type === 'call_transfered'\n                  ? 'pi-text-green-700 dark:pi-text-green-200'\n                  : 'pi-text-rose-700 dark:pi-text-rose-200'\n              }`}\n              aria-hidden='true'\n            />\n          </div>\n\n          <div className='ml-3'>\n            <h3 className='pi-text-lg pi-font-medium pi-text-gray-900 dark:pi-text-gray-50 pi-dark:text-rose-100 margin-block-property'>\n              {t(\n                `Errors.${\n                  default_device?.type === 'nethlink' && latestAlert?.type === 'webrtc_down'\n                    ? latestAlert?.nethlink_message\n                    : latestAlert?.type\n                }`,\n              )}\n            </h3>\n            <div className='pi-text-sm pi-font-normal pi-text-gray-700 dark:pi-text-gray-200 pi-dark:text-rose-200 pi-leading-5'>\n              {t(`Errors.${latestAlert?.message}`)}\n            </div>\n          </div>\n        </div>\n\n        {/* Close button */}\n        <Button\n          variant='transparent'\n          onClick={() =>\n            default_device?.type === 'nethlink' &&\n            uaType === 'mobile' &&\n            latestAlert?.type !== 'call_transfered'\n              ? reloadPhoneIsland()\n              : handleClearAllAlerts()\n          }\n          className='pi-absolute pi--right-6 pi-transform pi--translate-y-1/2'\n          data-tooltip-id='tooltip-close-alert'\n          data-tooltip-content={\n            default_device?.type === 'nethlink' &&\n            uaType === 'mobile' &&\n            latestAlert?.type !== 'call_transfered'\n              ? `${t('Tooltip.Reload')}`\n              : `${t('Tooltip.Close alert')}`\n          }\n        >\n          <FontAwesomeIcon\n            icon={\n              default_device?.type === 'nethlink' && latestAlert?.type !== 'call_transfered'\n                ? faArrowRotateRight\n                : faTimes\n            }\n            className='pi-text-gray-700 dark:pi-text-gray-50 pi-w-4 pi-h-4'\n          />\n        </Button>\n        <CustomThemedTooltip id='tooltip-close-alert' place='left' />\n      </div>\n    )\n  )\n}\n\ninterface AlertViewProp {\n  uaType?: string\n}\n\nexport default AlertView\n"],"names":["_a","uaType","data","useSelector","state","alerts","default_device","currentUser","dispatch","useDispatch","activeAlerts","Object","values","filter","alert","active","latestAlert","length","React","createElement","className","concat","type","FontAwesomeIcon","icon","faCircleCheck","faCircleXmark","t","nethlink_message","message","Button","variant","onClick","window","location","reload","removeAllAlerts","eventDispatch","faArrowRotateRight","faTimes","CustomThemedTooltip","id","place"],"mappings":"svBAqBqC,SAACA,GAAE,IAAAC,EAAMD,EAAAC,OACpCC,EAASC,eAAY,SAACC,GAAqB,OAAAA,EAAMC,eACjDC,EAAmBH,eAAY,SAACC,GAAqB,OAAAA,EAAMG,8BAC7DC,EAAWC,EAAAA,cAGXC,EAAeC,OAAOC,OAAOV,GAAMW,QAAO,SAACC,GAAe,OAAAA,EAAMC,MAAM,IAGtEC,EAAcN,EAAaO,OAAS,EAAIP,EAAaA,EAAaO,OAAS,GAAK,KAWtF,OACED,GACEE,EAAAA,QAAKC,cAAA,MAAA,CAAAC,UAAU,+CACbF,EAAAA,QAAKC,cAAA,MAAA,CAAAC,UAAU,2BACbF,EAAA,QAAAC,cAAA,MAAA,CACEC,UAAW,sGACTC,OAAsB,qBAAtBL,aAAW,EAAXA,EAAaM,MACT,uCACA,uCAINJ,EAAAA,QAAAC,cAACI,EAAAA,gBAAe,CACdC,KAA4B,qBAAtBR,aAAW,EAAXA,EAAaM,MAA6BG,EAAaA,cAAGC,EAAaA,cAC7EN,UAAW,kBACTC,OAAsB,qBAAtBL,aAAA,EAAAA,EAAaM,MACT,2CACA,0CAEM,cAAA,UAIhBJ,EAAAA,QAAKC,cAAA,MAAA,CAAAC,UAAU,QACbF,EAAAA,QAAIC,cAAA,KAAA,CAAAC,UAAU,+GACXO,IACC,UAAAN,OAC2B,cAAzBf,aAAA,EAAAA,EAAgBgB,OAA6C,iBAAtBN,aAAW,EAAXA,EAAaM,MAChDN,aAAA,EAAAA,EAAaY,iBACbZ,aAAW,EAAXA,EAAaM,QAIvBJ,UAAAC,cAAA,MAAA,CAAKC,UAAU,uGACZO,EAAAA,EAAE,iBAAUX,aAAW,EAAXA,EAAaa,aAMhCX,EAAA,QAAAC,cAACW,EAAMA,OACL,CAAAC,QAAQ,cACRC,QAAS,WACP,MAAyB,cAAzB1B,eAAAA,EAAgBgB,OACL,WAAXrB,GACsB,qBAAtBe,aAAW,EAAXA,EAAaM,WAhDrBW,OAAOC,SAASC,UALhB3B,EAASH,OAAO+B,uBAChBC,gBAAc,kCAAmC,CAAA,GAkDzC,EAMFjB,UAAU,2DAA0D,kBACpD,sBAEd,uBAAyB,cAAzBd,aAAA,EAAAA,EAAgBgB,OACL,WAAXrB,GACsB,qBAAtBe,aAAW,EAAXA,EAAaM,MACT,GAAGD,OAAAM,IAAE,mBACL,GAAGN,OAAAM,IAAE,yBAGXT,EAAAA,QAACC,cAAAI,kBACC,CAAAC,KAC2B,cAAzBlB,aAAA,EAAAA,EAAgBgB,OAA6C,qBAAtBN,eAAAA,EAAaM,MAChDgB,EAAkBA,mBAClBC,UAENnB,UAAU,yDAGdF,UAAAC,cAACqB,EAAmBA,oBAAA,CAACC,GAAG,sBAAsBC,MAAM,SAI5D"}
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../node_modules/tslib/tslib.es6.js"),t=require("react"),r=require("../services/user.js"),s=require("../lib/avatars/avatars.js");require("../node_modules/react-redux/es/index.js");var n=require("../services/astproxy.js"),u=require("../lib/user/extensions.js"),a=require("../node_modules/react-redux/es/hooks/useDispatch.js"),i=require("../node_modules/react-redux/es/hooks/useSelector.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=o(t);exports.RestAPI=function(o){var l=o.hostName,f=o.username,d=o.authToken,h=o.children,p=a.useDispatch(),v=i.useSelector((function(e){return e.fetchDefaults})).fetchReady;return t.useEffect((function(){f&&d&&l&&(p.fetchDefaults.updateFetchBaseURL("https://".concat(l,"/webrest")),p.fetchDefaults.updateFetchHeaders({Authorization:"".concat(f,":").concat(d)}),p.fetchDefaults.setFetchReady())}),[f,d,l]),t.useEffect((function(){v&&(function(){e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(s){switch(s.label){case 0:return[4,r.getCurrentUserInfo()];case 1:return(t=s.sent())&&(p.currentUser.updateCurrentUser(t),p.currentUser.setCurrentUserReady(!0),t.settings&&t.settings.open_param_url?p.paramUrl.setOpenParamUrlType(t.settings.open_param_url):p.paramUrl.setOpenParamUrlType("never"),function(){e.__awaiter(this,void 0,void 0,(function(){var t,r;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,n.getAllExtensions()];case 1:return(t=e.sent())&&(p.users.updateExtensions(t),r=u.getExtensionsList(),Object.values(t).filter((function(e){return r.includes(e.exten)})).forEach((function(e){return p.currentUser.updateConversations(e)}))),[2]}}))}))}()),[2]}}))}))}(),function(){e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,r.getAllUsersEndpoints()];case 1:return(t=e.sent())&&p.users.updateEndpoints(t),[2]}}))}))}(),function(){e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,r.getVideoSources()];case 1:return(t=e.sent())&&p.streaming.updateVideoSources(t),[2]}}))}))}())}),[v]),t.useLayoutEffect((function(){f&&v&&s.retrieveAvatars(f)}),[v,f]),c.default.createElement(c.default.Fragment,null,v&&h)};
//# sourceMappingURL=RestAPI.js.map

{"version":3,"file":"BackCall.js","sources":["../../../src/components/CallView/BackCall.tsx"],"sourcesContent":["// Copyright (C) 2024 Nethesis S.r.l.\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport React, { FC, useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Dispatch, RootState } from '../../store'\nimport Timer from './Timer'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport { TransferCallsTypes } from '../../models/currentCall'\nimport { faDisplay } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { useTranslation } from 'react-i18next'\nimport AvatarGroup from '../AvatarGroup'\nimport { isEmpty } from '../../utils/genericFunctions/isEmpty'\n\nconst BackCall: FC<BackCallTypes> = ({ isVisible }) => {\n  const {\n    number,\n    displayName,\n    transferring,\n    transferringName,\n    startTime,\n    transferringStartTime,\n    transferCalls,\n  } = useSelector((state: RootState) => state.currentCall)\n  const dispatch = useDispatch<Dispatch>()\n\n  const { t } = useTranslation()\n  const { isOpen, previousView } = useSelector((state: RootState) => state.island)\n  const { active: screenShareActive, role: screenShareRole } = useSelector(\n    (state: RootState) => state.screenShare,\n  )\n  const { isActive, usersList, ownerInformations }: any = useSelector(\n    (state: RootState) => state.conference,\n  )\n\n  useEffect(() => {\n    const callData: TransferCallsTypes = transferCalls.find((item) => item.number !== number)\n    // Handle call switch during transfer\n    if (callData) {\n      dispatch.currentCall.updateCurrentCall({\n        transferringName: callData.displayName,\n        transferringStartTime: callData.startTime,\n      })\n    }\n  }, [number])\n\n  return (\n    <AnimatePresence>\n      {isVisible && (\n        <motion.div\n          className={`pi-absolute pi-w-full pi-bg-gray-700 pi-flex pi-justify-between pi-text-gray-50 dark:pi-text-gray-50 -pi-mt-10 -pi-z-10 pi-items-start ${\n            isOpen ? 'pi-px-6' : 'pi-px-4'\n          } pi-pt-3`}\n          style={{ borderTopLeftRadius: '20px', borderTopRightRadius: '20px', height: '60px' }}\n          initial={{ y: 60 }}\n          animate={{ y: 0 }}\n          exit={{\n            y: 60,\n            transitionEnd: {\n              display: 'none',\n            },\n          }}\n          transition={{ duration: 0.12, ease: 'easeOut' }}\n        >\n          <div className='pi-font-medium pi-text-sm pi-relative'>\n            <div\n              className={`pi-whitespace-nowrap pi-overflow-hidden ${\n                isOpen && previousView !== 'video' ? 'pi-w-44' : 'pi-w-16'\n              }`}\n            >\n              {transferring\n                ? transferringName\n                : isActive && !isEmpty(ownerInformations)\n                ? t('Conference.In conference')\n                : isActive && isEmpty(ownerInformations)\n                ? t('Conference.Waiting for the conference')\n                : previousView === 'recorder'\n                ? t('Common.Record message')\n                : previousView === 'player'\n                ? t('Common.Play message')\n                : displayName}\n            </div>\n            <div className='pi-w-6 pi-absolute pi-right-0 pi-top-0 pi-h-full pi-bg-gradient-to-r pi-from-transparent pi-to-gray-700'></div>\n          </div>\n          <div className='pi-flex pi-gap-5'>\n            {/* Screen sharing badge */}\n            {screenShareActive && screenShareRole === 'publisher' && (\n              <div className='pi-flex pi-gap-2 pi-font-medium pi-items-center pi-rounded-full pi-px-2 pi-py-1 pi-text-xs pi-relative -pi-top-0.5 pi-bg-emerald-700 pi-text-emerald-50'>\n                <FontAwesomeIcon icon={faDisplay} className='pi-w-4 pi-h-4' />\n                {t('Screen sharing.Sharing')}\n              </div>\n            )}\n            <div className='pi-w-16 pi-flex pi-justify-end'>\n              {!isActive && previousView !== 'recorder' && previousView !== 'player' ? (\n                <Timer size='small' startTime={transferring ? transferringStartTime : startTime} />\n              ) : (\n                <AvatarGroup usersList={usersList || {}} maxAvatars={5} />\n              )}\n            </div>\n          </div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  )\n}\n\nexport default BackCall\n\ninterface BackCallTypes {\n  isVisible: boolean\n}\n"],"names":["_a","isVisible","_b","useSelector","state","currentCall","number","displayName","transferring","transferringName","startTime","transferringStartTime","transferCalls","dispatch","useDispatch","t","useTranslation","_c","island","isOpen","previousView","_d","screenShare","screenShareActive","screenShareRole","_e","conference","isActive","usersList","ownerInformations","useEffect","callData","find","item","updateCurrentCall","React","createElement","AnimatePresence","motion","div","className","concat","style","borderTopLeftRadius","borderTopRightRadius","height","initial","y","animate","exit","transitionEnd","display","transition","duration","ease","isEmpty","FontAwesomeIcon","icon","faDisplay","AvatarGroup","maxAvatars","Timer","size"],"mappings":"2zCAeoC,SAACA,GAAE,IAAAC,EAASD,EAAAC,UACxCC,EAQFC,EAAWA,aAAC,SAACC,GAAqB,OAAAA,EAAMC,WAAN,IAPpCC,EAAMJ,EAAAI,OACNC,EAAWL,EAAAK,YACXC,EAAYN,EAAAM,aACZC,EAAgBP,EAAAO,iBAChBC,EAASR,EAAAQ,UACTC,EAAqBT,EAAAS,sBACrBC,kBAEIC,EAAWC,EAAAA,cAETC,EAAMC,qBACRC,EAA2Bd,EAAAA,aAAY,SAACC,GAAqB,OAAAA,EAAMc,MAAM,IAAvEC,WAAQC,iBACVC,EAAuDlB,EAAAA,aAC3D,SAACC,GAAqB,OAAAA,EAAMkB,WAAW,IADzBC,WAAyBC,SAGnCC,EAAkDtB,EAAAA,aACtD,SAACC,GAAqB,OAAAA,EAAMsB,cADtBC,EAAQF,EAAAE,SAAEC,EAASH,EAAAG,UAAEC,EAAiBJ,EAAAI,kBAe9C,OAXAC,EAAAA,WAAU,WACR,IAAMC,EAA+BnB,EAAcoB,MAAK,SAACC,GAAS,OAAAA,EAAK3B,SAAWA,CAAhB,IAE9DyB,GACFlB,EAASR,YAAY6B,kBAAkB,CACrCzB,iBAAkBsB,EAASxB,YAC3BI,sBAAuBoB,EAASrB,WAGtC,GAAG,CAACJ,IAGF6B,EAAAA,QAACC,cAAAC,EAAeA,gBACb,KAAApC,GACCkC,EAAC,QAAAC,cAAAE,EAAAA,OAAOC,IACN,CAAAC,UAAW,0IAAAC,OACTtB,EAAS,UAAY,UAAS,YAEhCuB,MAAO,CAAEC,oBAAqB,OAAQC,qBAAsB,OAAQC,OAAQ,QAC5EC,QAAS,CAAEC,EAAG,IACdC,QAAS,CAAED,EAAG,GACdE,KAAM,CACJF,EAAG,GACHG,cAAe,CACbC,QAAS,SAGbC,WAAY,CAAEC,SAAU,IAAMC,KAAM,YAEpCnB,EAAAA,QAAKC,cAAA,MAAA,CAAAI,UAAU,yCACbL,EAAAA,QAAAC,cAAA,MAAA,CACEI,UAAW,2CAAAC,OACTtB,GAA2B,UAAjBC,EAA2B,UAAY,YAGlDZ,EACGC,EACAkB,IAAa4B,EAAOA,QAAC1B,GACrBd,EAAE,4BACFY,GAAY4B,EAAOA,QAAC1B,GACpBd,EAAE,yCACe,aAAjBK,EACAL,EAAE,yBACe,WAAjBK,EACAL,EAAE,uBACFR,GAEN4B,EAAA,QAAAC,cAAA,MAAA,CAAKI,UAAU,6GAEjBL,EAAAA,QAAKC,cAAA,MAAA,CAAAI,UAAU,oBAEZjB,GAAyC,cAApBC,GACpBW,EAAA,QAAAC,cAAA,MAAA,CAAKI,UAAU,2JACbL,EAAC,QAAAC,cAAAoB,mBAAgBC,KAAMC,YAAWlB,UAAU,kBAC3CzB,EAAE,2BAGPoB,EAAA,QAAAC,cAAA,MAAA,CAAKI,UAAU,kCACXb,GAA6B,aAAjBP,GAAgD,WAAjBA,EAG3Ce,EAAAA,QAAAC,cAACuB,EAAAA,QAAW,CAAC/B,UAAWA,GAAa,CAAA,EAAIgC,WAAY,IAFrDzB,EAAC,QAAAC,cAAAyB,EAAK,QAAC,CAAAC,KAAK,QAAQpD,UAAWF,EAAeG,EAAwBD,OAUtF"}
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");require("../node_modules/react-redux/es/index.js");var t=require("../utils/customHooks/useIsomorphicLayoutEffect.js"),i=require("../store/index.js"),r=require("./CallView/index.js"),n=require("./KeypadView/index.js"),l=require("./AudioPlayerView/index.js"),a=require("./AlertGuard.js"),u=require("./CallView/BackCall.js"),s=require("./SideView/SideView.js"),c=require("./ViewsTransition.js"),o=require("./RecorderView/index.js"),d=require("./IslandMotion.js"),f=require("./IslandDrag.js"),w=require("./PhysicalRecorderView/index.js"),m=require("./SettingsView/index.js"),p=require("./SwitchDeviceView/index.js"),V=require("../utils/genericFunctions/isBackCallVisible.js"),y=require("./VideoView/index.js"),E=require("./ConferenceView/index.js"),g=require("./ContactView/ContactListView.js"),h=require("./StreamingAnswerView/index.js"),j=require("../node_modules/react-redux/es/hooks/useSelector.js"),q=require("../node_modules/react-redux/es/hooks/useDispatch.js");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var S=v(e),x=function(v){var x=v.showAlways,C=v.uaType,R=j.useSelector((function(e){return e.currentCall})),A=R.incoming,I=R.accepted,P=R.outgoing,D=j.useSelector((function(e){return e.island})),b=D.view,k=D.sideViewIsVisible,L=D.avoidToShow,T=D.previousView,_=j.useSelector((function(e){return{recording:e.physicalRecorder.recording}})).recording,F=j.useSelector((function(e){return e.alerts.status})).activeAlertsCount,B=j.useSelector((function(e){return e.player})).audioPlayerLoop,K=j.useSelector((function(e){return e.conference})).isActive,M=e.useRef(null),N=q.useDispatch(),G=e.useRef(null),O=e.useRef(null),W=e.useRef(null);t.useIsomorphicLayoutEffect((function(){N.player.updatePlayer({audioPlayer:G,localAudio:O,remoteAudio:W})}),[]),e.useEffect((function(){var e=i.store.getState().conference,t=e.isActive,r=e.conferenceStartedFrom,n=e.isOwnerInside,l=i.store.getState().currentUser.username;(A||P)&&t&&r===l&&n?N.island.setIslandView("waitingConference"):!A&&!P||L||N.island.setIslandView("call")}),[A,P]),e.useEffect((function(){_&&N.island.setIslandView("physicalPhoneRecorder")}),[b]);var z,H=e.useState(""),U=H[0],J=H[1];return e.useEffect((function(){setTimeout((function(){J(b)}),200)}),[b]),S.default.createElement("div",{ref:M,className:"pi-absolute pi-min-w-full pi-min-h-full pi-left-0 pi-top-0 pi-overflow-hidden pi-pointer-events-none pi-flex pi-items-center pi-justify-center pi-content-center pi-phone-island-container pi-z-1000"},(A||P||I||x||F>0||"player"===b||"recorder"===b||"physicalPhoneRecorder"===b||"waitingConference"===b&&K||"transfer"===b&&K||"settings"===b&&K||"settings"===b&&("recorder"===T||"player"===T))&&!L&&S.default.createElement(S.default.Fragment,null,S.default.createElement(f.IslandDrag,{islandContainerRef:M},S.default.createElement(u.default,{isVisible:V.isBackCallActive()}),S.default.createElement(s.default,{isVisible:k,uaType:C}),S.default.createElement(d.IslandMotion,null,S.default.createElement(a.AlertGuard,{uaType:C},(z={call:r.default?S.default.createElement(r.default,null):null,keypad:n.default?S.default.createElement(n.default,null):null,transfer:g.ContactListView?S.default.createElement(g.ContactListView,null):null,player:l.KeypadView?S.default.createElement(l.KeypadView,null):null,recorder:o.RecorderView?S.default.createElement(o.RecorderView,null):null,physicalPhoneRecorder:w.PhysicalRecorderView?S.default.createElement(w.PhysicalRecorderView,null):null,settings:m.SettingsView?S.default.createElement(m.SettingsView,null):null,video:y.VideoView?S.default.createElement(y.VideoView,null):null,switchDevice:p.SwitchDeviceView?S.default.createElement(p.SwitchDeviceView,null):null,waitingConference:E.WaitingConferenceView?S.default.createElement(E.WaitingConferenceView,null):null,streamingAnswer:h.StreamingAnswerView?S.default.createElement(h.StreamingAnswerView,null):null},U in z&&z[U]?S.default.createElement(c.default,{forView:U},z[U]):S.default.createElement(S.default.Fragment,null)))))),S.default.createElement("div",{className:"pi-hidden"},S.default.createElement("audio",{loop:B,ref:G}),S.default.createElement("audio",{muted:!0,ref:O}),S.default.createElement("audio",{autoPlay:!0,ref:W})))};x.displayName="Island",exports.Island=x;
//# sourceMappingURL=Island.js.map

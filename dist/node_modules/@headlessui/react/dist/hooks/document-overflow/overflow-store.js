"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../utils/disposables.js"),t=require("../../utils/store.js"),o=require("./adjust-scrollbar-padding.js"),r=require("./handle-ios-locking.js"),s=require("./prevent-scroll.js");function l(e){let t={};for(let o of e)Object.assign(t,o(t));return t}let d=t.createStore((()=>new Map),{PUSH(t,o){var r;let s=null!=(r=this.get(t))?r:{doc:t,count:0,d:e.disposables(),meta:new Set};return s.count++,s.meta.add(o),this.set(t,s),this},POP(e,t){let o=this.get(e);return o&&(o.count--,o.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:d}){let i={doc:e,d:t,meta:l(d)},n=[r.handleIOSLocking(),o.adjustScrollbarPadding(),s.preventScroll()];n.forEach((({before:e})=>null==e?void 0:e(i))),n.forEach((({after:e})=>null==e?void 0:e(i)))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});d.subscribe((()=>{let e=d.getSnapshot(),t=new Map;for(let[o]of e)t.set(o,o.documentElement.style.overflow);for(let o of e.values()){let e="hidden"===t.get(o.doc),r=0!==o.count;(r&&!e||!r&&e)&&d.dispatch(o.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",o),0===o.count&&d.dispatch("TEARDOWN",o)}})),exports.overflows=d;
//# sourceMappingURL=overflow-store.js.map

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../../@floating-ui/react/dist/floating-ui.react.mjs.js"),t=require("react"),n=require("../hooks/use-disposables.js"),r=require("../hooks/use-event.js"),o=require("../hooks/use-iso-morphic-effect.js"),l=require("../../../../@floating-ui/react-dom/dist/floating-ui.react-dom.mjs.js"),i=require("../../../../@floating-ui/dom/dist/floating-ui.dom.mjs.js");function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var a=s(t);let u=t.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});u.displayName="FloatingContext";let f=t.createContext(null);f.displayName="PlacementContext";function c(e,l,i=void 0){let s=n.useDisposables(),a=r.useEvent(((e,t)=>{if(null==e)return[i,null];if("number"==typeof e)return[e,null];if("string"==typeof e){if(!t)return[i,null];let n=g(e,t);return[n,r=>{let o=p(e);{let l=o.map((e=>window.getComputedStyle(t).getPropertyValue(e)));s.requestAnimationFrame((function i(){s.nextFrame(i);let a=!1;for(let[e,n]of o.entries()){let r=window.getComputedStyle(t).getPropertyValue(n);if(l[e]!==r){l[e]=r,a=!0;break}}if(!a)return;let u=g(e,t);n!==u&&(r(u),n=u)}))}return s.dispose}]}return[i,null]})),u=t.useMemo((()=>a(e,l)[0]),[e,l]),[f=u,c]=t.useState();return o.useIsoMorphicEffect((()=>{let[t,n]=a(e,l);if(c(t),n)return n(c)}),[e,l]),f}function p(e){let t=/var\((.*)\)/.exec(e);if(t){let e=t[1].indexOf(",");if(-1===e)return[t[1]];let n=t[1].slice(0,e).trim(),r=t[1].slice(e+1).trim();return r?[n,...p(r)]:[n]}return[]}function g(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let r=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),r}exports.FloatingProvider=function({children:n,enabled:s=!0}){let[p,g]=t.useState(null),[d,m]=t.useState(0),h=t.useRef(null),[v,x]=t.useState(null);!function(e){o.useIsoMorphicEffect((()=>{if(!e)return;let t=new MutationObserver((()=>{let t=window.getComputedStyle(e).maxHeight,n=parseFloat(t);if(isNaN(n))return;let r=parseInt(t);isNaN(r)||n!==r&&(e.style.maxHeight=`${Math.ceil(n)}px`)}));return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}}),[e])}(v);let y=s&&null!==p&&null!==v,{to:b="bottom",gap:P=0,offset:F=0,padding:C=0,inner:M}=function(e,t){var n,r,o;let l=c(null!=(n=null==e?void 0:e.gap)?n:"var(--anchor-gap, 0)",t),i=c(null!=(r=null==e?void 0:e.offset)?r:"var(--anchor-offset, 0)",t),s=c(null!=(o=null==e?void 0:e.padding)?o:"var(--anchor-padding, 0)",t);return{...e,gap:l,offset:i,padding:s}}(p,v),[j,w="center"]=b.split(" ");o.useIsoMorphicEffect((()=>{y&&m(0)}),[y]);let{refs:O,floatingStyles:R,context:E}=e.useFloating({open:y,placement:"selection"===j?"center"===w?"bottom":`bottom-${w}`:"center"===w?`${j}`:`${j}-${w}`,strategy:"absolute",transform:!1,middleware:[l.offset({mainAxis:"selection"===j?0:P,crossAxis:F}),l.shift({padding:C}),"selection"!==j&&l.flip({padding:C}),"selection"===j&&M?e.inner({...M,padding:C,overflowRef:h,offset:d,minItemsVisible:4,referenceOverflowThreshold:C,onFallbackChange(e){var t,n;if(!e)return;let r=E.elements.floating;if(!r)return;let o=parseFloat(getComputedStyle(r).scrollPaddingBottom)||0,l=Math.min(4,r.childElementCount),i=0,s=0;for(let e of null!=(n=null==(t=E.elements.floating)?void 0:t.childNodes)?n:[])if(e instanceof HTMLElement){let t=e.offsetTop,n=t+e.clientHeight+o,a=r.scrollTop,u=a+r.clientHeight;if(!(t>=a&&n<=u)){s=Math.max(0,Math.min(n,u)-Math.max(t,a)),i=e.clientHeight;break}l--}l>=1&&m((e=>{let t=i*l-s+o;return e>=t?e:t}))}}):null,l.size({padding:C,apply({availableWidth:e,availableHeight:t,elements:n}){Object.assign(n.floating.style,{overflow:"auto",maxWidth:`${e}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${t}px)`})}})].filter(Boolean),whileElementsMounted:i.autoUpdate}),[S=j,H=w]=E.placement.split("-");"selection"===j&&(S="selection");let k=t.useMemo((()=>({anchor:[S,H].filter(Boolean).join(" ")})),[S,H]),q=e.useInnerOffset(E,{overflowRef:h,onChange:m}),{getReferenceProps:I,getFloatingProps:N}=e.useInteractions([q]),$=r.useEvent((e=>{x(e),O.setFloating(e)}));return a.createElement(f.Provider,{value:g},a.createElement(u.Provider,{value:{setFloating:$,setReference:O.setReference,styles:R,getReferenceProps:I,getFloatingProps:N,slot:k}},n))},exports.useFloatingPanel=function(e=null){!1===e&&(e=null),"string"==typeof e&&(e={to:e});let n=t.useContext(f),r=t.useMemo((()=>e),[JSON.stringify(e,((e,t)=>{var n;return null!=(n=null==t?void 0:t.outerHTML)?n:t}))]);o.useIsoMorphicEffect((()=>{null==n||n(null!=r?r:null)}),[n,r]);let l=t.useContext(u);return t.useMemo((()=>[l.setFloating,e?l.styles:{}]),[l.setFloating,e,l.styles])},exports.useFloatingPanelProps=function(){let{getFloatingProps:e,slot:n}=t.useContext(u);return t.useCallback(((...t)=>Object.assign({},e(...t),{"data-anchor":n.anchor})),[e,n])},exports.useFloatingReference=function(){return t.useContext(u).setReference},exports.useFloatingReferenceProps=function(){return t.useContext(u).getReferenceProps},exports.useResolvedAnchor=function(e){return t.useMemo((()=>e?"string"==typeof e?{to:e}:e:null),[e])};
//# sourceMappingURL=floating.js.map

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("../../../../_virtual/_commonjsHelpers.js"),r=require("../../../../_virtual/tools-ebml.js"),n=require("./tools.js");exports.__require=function(){if(e)return r.__exports;e=1;var a=t.commonjsGlobal&&t.commonjsGlobal.__assign||function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},a.apply(this,arguments)},o=t.commonjsGlobal&&t.commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(r.__exports,"__esModule",{value:!0});var u=n.__require(),c=function(){function e(){}return e.readVint=function(t,r){void 0===r&&(r=0);var n=8-Math.floor(Math.log2(t[r]));if(n>8){var a=e.readHexString(t,r,r+n);throw new Error("Unrepresentable length: ".concat(n," ").concat(a))}if(r+n>t.length)return null;for(var o=t[r]&(1<<8-n)-1,u=1;u<n;u+=1){if(7===u&&o>=Math.pow(2,8)&&t[r+7]>0)return{length:n,value:-1};o*=Math.pow(2,8),o+=t[r+u]}return{length:n,value:o}},e.writeVint=function(e){if(e<0||e>Math.pow(2,53))throw new Error("Unrepresentable value: ".concat(e));var t=1;for(t=1;t<=8&&!(e<Math.pow(2,7*t)-1);t+=1);for(var r=u.Buffer.alloc(t),n=e,a=1;a<=t;a+=1){var o=255&n;r[t-a]=o,n-=o,n/=Math.pow(2,8)}return r[0]|=1<<8-t,r},e.concatenate=function(e,t){return e||t?e&&0!==e.byteLength?t&&0!==t.byteLength?u.Buffer.from(o(o([],e,!0),t,!0)):e:t:u.Buffer.from([])},e.readHexString=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),Array.from(e.slice(t,r)).map((function(e){return Number(e).toString(16)})).reduce((function(e,t){return"".concat(e).concat(t.padStart(2,"0"))}),"")},e.readUtf8=function(e){try{return u.Buffer.from(e).toString("utf8")}catch(e){return null}},e.readUnsigned=function(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 1:return r.getUint8(0);case 2:return r.getUint16(0);case 4:return r.getUint32(0)}return t.byteLength<=6?t.reduce((function(e,t){return 256*e+t}),0):e.readHexString(t,0,t.byteLength)},e.readSigned=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 1:return t.getInt8(0);case 2:return t.getInt16(0);case 4:return t.getInt32(0);default:return NaN}},e.readFloat=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return t.getFloat32(0);case 8:return t.getFloat64(0);default:return NaN}},e.readDate=function(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 1:return new Date(r.getUint8(0));case 2:return new Date(r.getUint16(0));case 4:return new Date(r.getUint32(0));case 8:return new Date(Number.parseInt(e.readHexString(t),16));default:return new Date(0)}},e.readDataFromTag=function(t,r){var n,o=t.type,u=t.name,c=t.track,i=t.discardable||!1,f=t.keyframe||!1,l=null;switch(o){case"u":n=e.readUnsigned(r);break;case"f":n=e.readFloat(r);break;case"i":n=e.readSigned(r);break;case"s":n=String.fromCharCode.apply(String,r);break;case"8":n=e.readUtf8(r);break;case"d":n=e.readDate(r)}if("SimpleBlock"===u||"Block"===u){var s=0,g=e.readVint(r,s),d=g.length;s+=d,c=g.value,n=e.readSigned(r.subarray(s,s+2)),s+=2,"SimpleBlock"===u&&(f=Boolean(128&r[d+2]),i=Boolean(1&r[d+2])),s+=1,l=r.subarray(s)}return a(a({},t),{data:r,discardable:i,keyframe:f,payload:l,track:c,value:n})},e}();return r.__exports.default=c,r.__exports};
//# sourceMappingURL=tools-ebml.js.map

{"version":3,"file":"useTranslation.js","sources":["../../../../../node_modules/react-i18next/dist/es/useTranslation.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect, useContext, useRef } from 'react';\nimport { getI18n, getDefaults, ReportNamespaces, I18nContext } from './context.js';\nimport { warnOnce, loadNamespaces, loadLanguages, hasLoadedNamespace } from './utils.js';\n\nvar usePrevious = function usePrevious(value, ignore) {\n  var ref = useRef();\n  useEffect(function () {\n    ref.current = ignore ? ref.current : value;\n  }, [value, ignore]);\n  return ref.current;\n};\n\nexport function useTranslation(ns) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var i18nFromProps = props.i18n;\n\n  var _ref = useContext(I18nContext) || {},\n      i18nFromContext = _ref.i18n,\n      defaultNSFromContext = _ref.defaultNS;\n\n  var i18n = i18nFromProps || i18nFromContext || getI18n();\n  if (i18n && !i18n.reportNamespaces) i18n.reportNamespaces = new ReportNamespaces();\n\n  if (!i18n) {\n    warnOnce('You will need to pass in an i18next instance by using initReactI18next');\n\n    var notReadyT = function notReadyT(k, optsOrDefaultValue) {\n      if (typeof optsOrDefaultValue === 'string') return optsOrDefaultValue;\n      if (optsOrDefaultValue && _typeof(optsOrDefaultValue) === 'object' && typeof optsOrDefaultValue.defaultValue === 'string') return optsOrDefaultValue.defaultValue;\n      return Array.isArray(k) ? k[k.length - 1] : k;\n    };\n\n    var retNotReady = [notReadyT, {}, false];\n    retNotReady.t = notReadyT;\n    retNotReady.i18n = {};\n    retNotReady.ready = false;\n    return retNotReady;\n  }\n\n  if (i18n.options.react && i18n.options.react.wait !== undefined) warnOnce('It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.');\n\n  var i18nOptions = _objectSpread(_objectSpread(_objectSpread({}, getDefaults()), i18n.options.react), props);\n\n  var useSuspense = i18nOptions.useSuspense,\n      keyPrefix = i18nOptions.keyPrefix;\n  var namespaces = ns || defaultNSFromContext || i18n.options && i18n.options.defaultNS;\n  namespaces = typeof namespaces === 'string' ? [namespaces] : namespaces || ['translation'];\n  if (i18n.reportNamespaces.addUsedNamespaces) i18n.reportNamespaces.addUsedNamespaces(namespaces);\n  var ready = (i18n.isInitialized || i18n.initializedStoreOnce) && namespaces.every(function (n) {\n    return hasLoadedNamespace(n, i18n, i18nOptions);\n  });\n\n  function getT() {\n    return i18n.getFixedT(props.lng || null, i18nOptions.nsMode === 'fallback' ? namespaces : namespaces[0], keyPrefix);\n  }\n\n  var _useState = useState(getT),\n      _useState2 = _slicedToArray(_useState, 2),\n      t = _useState2[0],\n      setT = _useState2[1];\n\n  var joinedNS = namespaces.join();\n  if (props.lng) joinedNS = \"\".concat(props.lng).concat(joinedNS);\n  var previousJoinedNS = usePrevious(joinedNS);\n  var isMounted = useRef(true);\n  useEffect(function () {\n    var bindI18n = i18nOptions.bindI18n,\n        bindI18nStore = i18nOptions.bindI18nStore;\n    isMounted.current = true;\n\n    if (!ready && !useSuspense) {\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      } else {\n        loadNamespaces(i18n, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      }\n    }\n\n    if (ready && previousJoinedNS && previousJoinedNS !== joinedNS && isMounted.current) {\n      setT(getT);\n    }\n\n    function boundReset() {\n      if (isMounted.current) setT(getT);\n    }\n\n    if (bindI18n && i18n) i18n.on(bindI18n, boundReset);\n    if (bindI18nStore && i18n) i18n.store.on(bindI18nStore, boundReset);\n    return function () {\n      isMounted.current = false;\n      if (bindI18n && i18n) bindI18n.split(' ').forEach(function (e) {\n        return i18n.off(e, boundReset);\n      });\n      if (bindI18nStore && i18n) bindI18nStore.split(' ').forEach(function (e) {\n        return i18n.store.off(e, boundReset);\n      });\n    };\n  }, [i18n, joinedNS]);\n  var isInitial = useRef(true);\n  useEffect(function () {\n    if (isMounted.current && !isInitial.current) {\n      setT(getT);\n    }\n\n    isInitial.current = false;\n  }, [i18n, keyPrefix]);\n  var ret = [t, i18n, ready];\n  ret.t = t;\n  ret.i18n = i18n;\n  ret.ready = ready;\n  if (ready) return ret;\n  if (!ready && !useSuspense) return ret;\n  throw new Promise(function (resolve) {\n    if (props.lng) {\n      loadLanguages(i18n, props.lng, namespaces, function () {\n        return resolve();\n      });\n    } else {\n      loadNamespaces(i18n, namespaces, function () {\n        return resolve();\n      });\n    }\n  });\n}"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","ns","props","undefined","i18nFromProps","i18n","_ref","useContext","I18nContext","i18nFromContext","defaultNSFromContext","defaultNS","getI18n","reportNamespaces","ReportNamespaces","warnOnce","notReadyT","k","optsOrDefaultValue","_typeof","defaultValue","Array","isArray","retNotReady","t","ready","options","react","wait","i18nOptions","getDefaults","useSuspense","keyPrefix","namespaces","addUsedNamespaces","isInitialized","initializedStoreOnce","every","n","hasLoadedNamespace","getT","getFixedT","lng","nsMode","_useState","useState","_useState2","_slicedToArray","setT","joinedNS","join","concat","value","ignore","ref","previousJoinedNS","useRef","useEffect","current","isMounted","bindI18n","bindI18nStore","boundReset","loadLanguages","loadNamespaces","on","store","split","e","off","isInitial","ret","Promise","resolve"],"mappings":"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"}
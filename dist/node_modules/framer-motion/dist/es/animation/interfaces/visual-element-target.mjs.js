"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../render/utils/setters.mjs.js"),t=require("../../value/use-will-change/add-will-change.mjs.js"),i=require("../optimized-appear/get-appear-id.mjs.js"),n=require("./motion-value.mjs.js"),o=require("../../../../../motion-dom/dist/es/animation/utils/get-value-transition.mjs.js"),a=require("../../../../../motion-dom/dist/es/frameloop/frame.mjs.js"),s=require("../../../../../motion-dom/dist/es/render/utils/keys-position.mjs.js");function r({protectedKeys:e,needsAnimating:t},i){const n=e.hasOwnProperty(i)&&!0!==t[i];return t[i]=!1,n}exports.animateTarget=function(l,u,{delay:d=0,transitionOverride:m,type:p}={}){let{transition:c=l.getDefaultTransition(),transitionEnd:f,...g}=u;m&&(c=m);const j=[],y=p&&l.animationState&&l.animationState.getState()[p];for(const e in g){const u=l.getValue(e,l.latestValues[e]??null),m=g[e];if(void 0===m||y&&r(y,e))continue;const p={delay:d,...o.getValueTransition(c||{},e)},f=u.get();if(void 0!==f&&!u.isAnimating&&!Array.isArray(m)&&m===f&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const t=i.getOptimisedAppearId(l);if(t){const i=window.MotionHandoffAnimation(t,e,a.frame);null!==i&&(p.startTime=i,v=!0)}}t.addValueToWillChange(l,e),u.start(n.animateMotionValue(e,u,m,l.shouldReduceMotion&&s.positionalKeys.has(e)?{type:!1}:p,l,v));const h=u.animation;h&&j.push(h)}return f&&Promise.all(j).then((()=>{a.frame.update((()=>{f&&e.setTarget(l,f)}))})),j};
//# sourceMappingURL=visual-element-target.mjs.js.map

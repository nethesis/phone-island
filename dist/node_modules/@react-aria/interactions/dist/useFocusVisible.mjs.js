"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("../../utils/dist/useLayoutEffect.mjs.js");var e=require("react"),t=require("../../utils/dist/domHelpers.mjs.js"),n=require("../../utils/dist/platform.mjs.js");require("../../utils/dist/runAfterTransition.mjs.js");var o=require("../../utils/dist/isVirtualEvent.mjs.js");let r=null,i=new Set,d=new Map,s=!1,u=!1;const a={Tab:!0,Escape:!0};function l(e,t){for(let n of i)n(e,t)}function v(e){s=!0,function(e){return!(e.metaKey||!n.isMac()&&e.altKey||e.ctrlKey||"Control"===e.key||"Shift"===e.key||"Meta"===e.key)}(e)&&(r="keyboard",l("keyboard",e))}function c(e){r="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(s=!0,l("pointer",e))}function f(e){o.isVirtualClick(e)&&(s=!0,r="virtual")}function p(e){e.target!==window&&e.target!==document&&(s||u||(r="virtual",l("virtual",e)),s=!1,u=!1)}function m(){s=!1,u=!0}function E(e){if("undefined"==typeof window||d.get(t.getOwnerWindow(e)))return;const n=t.getOwnerWindow(e),o=t.getOwnerDocument(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){s=!0,r.apply(this,arguments)},o.addEventListener("keydown",v,!0),o.addEventListener("keyup",v,!0),o.addEventListener("click",f,!0),n.addEventListener("focus",p,!0),n.addEventListener("blur",m,!1),"undefined"!=typeof PointerEvent?(o.addEventListener("pointerdown",c,!0),o.addEventListener("pointermove",c,!0),o.addEventListener("pointerup",c,!0)):(o.addEventListener("mousedown",c,!0),o.addEventListener("mousemove",c,!0),o.addEventListener("mouseup",c,!0)),n.addEventListener("beforeunload",(()=>{w(e)}),{once:!0}),d.set(n,{focus:r})}const w=(e,n)=>{const o=t.getOwnerWindow(e),r=t.getOwnerDocument(e);n&&r.removeEventListener("DOMContentLoaded",n),d.has(o)&&(o.HTMLElement.prototype.focus=d.get(o).focus,r.removeEventListener("keydown",v,!0),r.removeEventListener("keyup",v,!0),r.removeEventListener("click",f,!0),o.removeEventListener("focus",p,!0),o.removeEventListener("blur",m,!1),"undefined"!=typeof PointerEvent?(r.removeEventListener("pointerdown",c,!0),r.removeEventListener("pointermove",c,!0),r.removeEventListener("pointerup",c,!0)):(r.removeEventListener("mousedown",c,!0),r.removeEventListener("mousemove",c,!0),r.removeEventListener("mouseup",c,!0)),d.delete(o))};function L(e){const n=t.getOwnerDocument(e);let o;return"loading"!==n.readyState?E(e):(o=()=>{E(e)},n.addEventListener("DOMContentLoaded",o)),()=>w(e,o)}function y(){return"pointer"!==r}"undefined"!=typeof document&&L();const g=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);exports.addWindowFocusTracking=L,exports.hasSetupGlobalListeners=d,exports.isFocusVisible=y,exports.useFocusVisibleListener=function(n,o,r){E(),e.useEffect((()=>{let e=(e,o)=>{(function(e,n,o){var r;const i="undefined"!=typeof window?t.getOwnerWindow(null==o?void 0:o.target).HTMLInputElement:HTMLInputElement,d="undefined"!=typeof window?t.getOwnerWindow(null==o?void 0:o.target).HTMLTextAreaElement:HTMLTextAreaElement,s="undefined"!=typeof window?t.getOwnerWindow(null==o?void 0:o.target).HTMLElement:HTMLElement,u="undefined"!=typeof window?t.getOwnerWindow(null==o?void 0:o.target).KeyboardEvent:KeyboardEvent;return!((e=e||(null==o?void 0:o.target)instanceof i&&!g.has(null==o||null===(r=o.target)||void 0===r?void 0:r.type)||(null==o?void 0:o.target)instanceof d||(null==o?void 0:o.target)instanceof s&&(null==o?void 0:o.target.isContentEditable))&&"keyboard"===n&&o instanceof u&&!a[o.key])})(!!(null==r?void 0:r.isTextInput),e,o)&&n(y())};return i.add(e),()=>{i.delete(e)}}),o)};
//# sourceMappingURL=useFocusVisible.mjs.js.map

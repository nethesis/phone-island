"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("./floating-ui.react.utils.mjs.js"),n=require("../../utils/dist/floating-ui.utils.mjs.js"),r=require("../../utils/dist/floating-ui.utils.dom.mjs.js"),o=require("react-dom"),l=require("../../react-dom/dist/floating-ui.react-dom.mjs.js"),s=require("../../core/dist/floating-ui.core.mjs.js");function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var u=c(e),i=c(o);const f={...u},a=f.useInsertionEffect||(e=>e());function d(e){const t=u.useRef((()=>{if("production"!==process.env.NODE_ENV)throw new Error("Cannot call an event handler while rendering.")}));return a((()=>{t.current=e})),u.useCallback((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)}),[])}var m="undefined"!=typeof document?e.useLayoutEffect:e.useEffect;let g=!1,p=0;const v=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+p++;const h=f.useId||function(){const[e,t]=u.useState((()=>g?v():void 0));return m((()=>{null==e&&t(v())}),[]),u.useEffect((()=>{g=!0}),[]),e};let x;"production"!==process.env.NODE_ENV&&(x=new Set);const w=u.createContext(null),b=u.createContext(null),R=()=>{var e;return(null==(e=u.useContext(w))?void 0:e.id)||null},E=()=>u.useContext(b),O="data-floating-ui-focusable";function y(e){const{open:t=!1,onOpenChange:n,elements:o}=e,l=h(),s=u.useRef({}),[c]=u.useState((()=>function(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,(null==(r=e.get(t))?void 0:r.filter((e=>e!==n)))||[])}}}())),i=null!=R();if("production"!==process.env.NODE_ENV){const e=o.reference;e&&!r.isElement(e)&&function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o="Floating UI: "+n.join(" ");var l;null!=(e=x)&&e.has(o)||(null==(l=x)||l.add(o),console.error(o))}("Cannot pass a virtual element to the `elements.reference` option,","as it must be a real DOM element. Use `refs.setPositionReference()`","instead.")}const[f,a]=u.useState(o.reference),m=d(((e,t,r)=>{s.current.openEvent=e?t:void 0,c.emit("openchange",{open:e,event:t,reason:r,nested:i}),null==n||n(e,t,r)})),g=u.useMemo((()=>({setPositionReference:a})),[]),p=u.useMemo((()=>({reference:f||o.reference||null,floating:o.floating||null,domReference:o.reference})),[f,o.reference,o.floating]);return u.useMemo((()=>({dataRef:s,open:t,onOpenChange:m,elements:p,events:c,floatingId:l,refs:g})),[t,m,p,c,l,g])}const C="active",j="selected";function M(e,t,n){const r=new Map,o="item"===n;let l=e;if(o&&e){const{[C]:t,[j]:n,...r}=e;l=r}return{..."floating"===n&&{tabIndex:-1,[O]:""},...l,...t.map((t=>{const r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,l]=t;var s;o&&[C,j].includes(n)||(0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof l&&(null==(s=r.get(n))||s.push(l),e[n]=function(){for(var e,t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];return null==(e=r.get(n))?void 0:e.map((e=>e(...o))).find((e=>void 0!==e))})):e[n]=l)})),e):e),{})}}function T(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}exports.getOverflowAncestors=r.getOverflowAncestors,exports.flip=l.flip,exports.offset=l.offset,exports.shift=l.shift,exports.size=l.size,exports.detectOverflow=s.detectOverflow,exports.inner=e=>({name:"inner",options:e,async fn(t){const{listRef:r,overflowRef:o,onFallbackChange:c,offset:u=0,index:f=0,minItemsVisible:a=4,referenceOverflowThreshold:d=0,scrollRef:m,...g}=n.evaluate(e,t),{rects:p,elements:{floating:v}}=t,h=r.current[f],w=(null==m?void 0:m.current)||v,b=v.clientTop||w.clientTop,R=0!==v.clientTop,E=0!==w.clientTop,O=v===w;if("production"!==process.env.NODE_ENV&&(t.placement.startsWith("bottom")||function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o="Floating UI: "+n.join(" ");var l;null!=(e=x)&&e.has(o)||(null==(l=x)||l.add(o),console.warn(o))}('`placement` side must be "bottom" when using the `inner`',"middleware.")),!h)return{};const y={...t,...await l.offset(-h.offsetTop-v.clientTop-p.reference.height/2-h.offsetHeight/2-u).fn(t)},C=await s.detectOverflow(T(y,w.scrollHeight+b+v.clientTop),g),j=await s.detectOverflow(y,{...g,elementContext:"reference"}),M=n.max(0,C.top),I=y.y+M,H=w.scrollHeight>w.clientHeight,F=(H?e=>e:n.round)(n.max(0,w.scrollHeight+(R&&O||E?2*b:0)-M-n.max(0,C.bottom)));if(w.style.maxHeight=F+"px",w.scrollTop=M,c){const e=H&&w.offsetHeight<h.offsetHeight*a-1||j.top>=-d||j.bottom>=-d;i.flushSync((()=>c(e)))}return o&&(o.current=await s.detectOverflow(T({...y,y:I},w.offsetHeight+b+v.clientTop),g)),{y:I}}}),exports.useFloating=function(e){void 0===e&&(e={});const{nodeId:t}=e,n=y({...e,elements:{reference:null,floating:null,...e.elements}}),o=e.rootContext||n,s=o.elements,[c,i]=u.useState(null),[f,a]=u.useState(null),d=(null==s?void 0:s.reference)||c,g=u.useRef(null),p=E();m((()=>{d&&(g.current=d)}),[d]);const v=l.useFloating({...e,elements:{...s,...f&&{reference:f}}}),h=u.useCallback((e=>{const t=r.isElement(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;a(t),v.refs.setReference(t)}),[v.refs]),x=u.useCallback((e=>{(r.isElement(e)||null===e)&&(g.current=e,i(e)),(r.isElement(v.refs.reference.current)||null===v.refs.reference.current||null!==e&&!r.isElement(e))&&v.refs.setReference(e)}),[v.refs]),w=u.useMemo((()=>({...v.refs,setReference:x,setPositionReference:h,domReference:g})),[v.refs,x,h]),b=u.useMemo((()=>({...v.elements,domReference:d})),[v.elements,d]),R=u.useMemo((()=>({...v,...o,refs:w,elements:b,nodeId:t})),[v,w,b,t,o]);return m((()=>{o.dataRef.current.floatingContext=R;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===t));e&&(e.context=R)})),u.useMemo((()=>({...v,context:R,refs:w,elements:b})),[v,w,b,R])},exports.useFloatingParentNodeId=R,exports.useFloatingRootContext=y,exports.useFloatingTree=E,exports.useId=h,exports.useInnerOffset=function(e,n){const{open:r,elements:o}=e,{enabled:l=!0,overflowRef:s,scrollRef:c,onChange:f}=n,a=d(f),m=u.useRef(!1),g=u.useRef(null),p=u.useRef(null);u.useEffect((()=>{if(!l)return;function e(e){if(e.ctrlKey||!n||null==s.current)return;const r=e.deltaY,o=s.current.top>=-.5,l=s.current.bottom>=-.5,c=n.scrollHeight-n.clientHeight,u=r<0?-1:1,f=r<0?"max":"min";n.scrollHeight<=n.clientHeight||(!o&&r>0||!l&&r<0?(e.preventDefault(),i.flushSync((()=>{a((e=>e+Math[f](r,c*u)))}))):/firefox/i.test(t.getUserAgent())&&(n.scrollTop+=r))}const n=(null==c?void 0:c.current)||o.floating;return r&&n?(n.addEventListener("wheel",e),requestAnimationFrame((()=>{g.current=n.scrollTop,null!=s.current&&(p.current={...s.current})})),()=>{g.current=null,p.current=null,n.removeEventListener("wheel",e)}):void 0}),[l,r,o.floating,s,c,a]);const v=u.useMemo((()=>({onKeyDown(){m.current=!0},onWheel(){m.current=!1},onPointerMove(){m.current=!1},onScroll(){const e=(null==c?void 0:c.current)||o.floating;if(s.current&&e&&m.current){if(null!==g.current){const t=e.scrollTop-g.current;(s.current.bottom<-.5&&t<-1||s.current.top<-.5&&t>1)&&i.flushSync((()=>a((e=>e+t))))}requestAnimationFrame((()=>{g.current=e.scrollTop}))}}})),[o.floating,a,s,c]);return u.useMemo((()=>l?{floating:v}:{}),[l,v])},exports.useInteractions=function(e){void 0===e&&(e=[]);const t=e.map((e=>null==e?void 0:e.reference)),n=e.map((e=>null==e?void 0:e.floating)),r=e.map((e=>null==e?void 0:e.item)),o=u.useCallback((t=>M(t,e,"reference")),t),l=u.useCallback((t=>M(t,e,"floating")),n),s=u.useCallback((t=>M(t,e,"item")),r);return u.useMemo((()=>({getReferenceProps:o,getFloatingProps:l,getItemProps:s})),[o,l,s])};
//# sourceMappingURL=floating-ui.react.mjs.js.map

{"version":3,"file":"select.esm.js","sources":["../../../../../node_modules/@rematch/select/dist/select.esm.js"],"sourcesContent":["import { createSelector, createStructuredSelector } from 'reselect';\nexport { createSelector, createStructuredSelector } from 'reselect';\n\nvar makeSelect = function makeSelect() {\n  function select(mapSelectToStructure, structuredSelectorCreator) {\n    if (structuredSelectorCreator === void 0) {\n      structuredSelectorCreator = createStructuredSelector;\n    }\n\n    var _func = function func(state, props) {\n      _func = structuredSelectorCreator(mapSelectToStructure(select));\n      return _func(state, props);\n    };\n\n    return function (state, props) {\n      return _func(state, props);\n    };\n  }\n\n  return select;\n};\n\nvar makeFactoryGroup = function makeFactoryGroup() {\n  var ready = false;\n  var factories = new Set();\n  return {\n    add: function add(added) {\n      if (!ready) {\n        added.forEach(function (factory) {\n          return factories.add(factory);\n        });\n      } else {\n        added.forEach(function (factory) {\n          return factory();\n        });\n      }\n    },\n    finish: function finish(factory) {\n      factories[\"delete\"](factory);\n    },\n    startBuilding: function startBuilding() {\n      ready = true;\n      factories.forEach(function (factory) {\n        return factory();\n      });\n    }\n  };\n};\n\nvar validateConfig = function validateConfig(config) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (config.sliceState && typeof config.sliceState !== 'function') {\n      throw new Error('select plugin config sliceState must be a function');\n    }\n\n    if (config.selectorCreator && typeof config.selectorCreator !== 'function') {\n      throw new Error('select plugin config selectorCreator must be a function');\n    }\n  }\n};\n\nvar validateSelector = function validateSelector(selectorFactories, selectorName, model) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof (selectorFactories == null ? void 0 : selectorFactories[selectorName]) !== 'function') {\n      throw new Error(\"Selector (\" + model.name + \"/\" + selectorName + \") must be a function\");\n    }\n  }\n};\n\nvar createSelectPlugin = function createSelectPlugin(config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  validateConfig(config);\n\n  var sliceState = config.sliceState || function (state, model) {\n    return state[model.name || ''];\n  };\n\n  var selectorCreator = config.selectorCreator || createSelector;\n\n  var slice = function slice(model) {\n    return function (stateOrNext) {\n      if (typeof stateOrNext === 'function') {\n        return selectorCreator(function (state) {\n          return sliceState(state, model);\n        }, stateOrNext);\n      }\n\n      return sliceState(stateOrNext, model);\n    };\n  };\n\n  var hasProps = function hasProps(inner) {\n    return function (models) {\n      var _this = this;\n\n      return selectorCreator(function (props) {\n        return props;\n      }, function (props) {\n        return inner.call(_this, models, props);\n      });\n    };\n  };\n\n  var factoryGroup = makeFactoryGroup();\n  var select = makeSelect();\n  return {\n    exposed: {\n      select: select,\n      sliceState: sliceState,\n      selectorCreator: selectorCreator\n    },\n    onModel: function onModel(model) {\n      select[model.name] = {};\n      var selectorFactories = typeof model.selectors === 'function' ? model.selectors(slice(model), selectorCreator, hasProps) : model.selectors;\n      factoryGroup.add(Object.keys(selectorFactories || {}).map(function (selectorName) {\n        validateSelector(selectorFactories, selectorName, model);\n\n        var factory = function factory() {\n          factoryGroup.finish(factory);\n          delete select[model.name][selectorName];\n          select[model.name][selectorName] = selectorFactories[selectorName].call(select[model.name], select);\n          return select[model.name][selectorName];\n        };\n\n        Object.defineProperty(select[model.name], selectorName, {\n          configurable: true,\n          get: function get() {\n            return factory();\n          }\n        });\n        return factory;\n      }));\n    },\n    onStoreCreated: function onStoreCreated(store) {\n      factoryGroup.startBuilding();\n      store.select = select;\n    }\n  };\n};\n\nexport { createSelectPlugin as default };\n//# sourceMappingURL=select.esm.js.map\n"],"names":["config","process","env","NODE_ENV","sliceState","Error","selectorCreator","validateConfig","ready","factories","state","model","name","createSelector","hasProps","inner","models","props","call","_this","factoryGroup","Set","add","added","forEach","factory","finish","startBuilding","select","mapSelectToStructure","structuredSelectorCreator","createStructuredSelector","_func","exposed","onModel","selectorFactories","selectors","stateOrNext","slice","Object","keys","map","selectorName","validateSelector","defineProperty","configurable","get","onStoreCreated","store"],"mappings":"uOAwF2B,SAI1BA,QAAA,IAAAA,IAAAA,EAA8C,CAAA,GAtCxB,SAItBA,GAEA,GAA6B,eAAzBC,QAAQC,IAAIC,SAA2B,CAC1C,GAAIH,EAAOI,YAA2C,mBAAtBJ,EAAOI,WACtC,MAAM,IAAIC,MAAM,sDAGjB,GACCL,EAAOM,iBAC2B,mBAA3BN,EAAOM,gBAEd,MAAM,IAAID,MAAM,0DAEjB,CACD,CAsBAE,CAAeP,GAEf,IA9DIQ,EACEC,EA6DAL,EACLJ,EAAOI,YAAe,SAACM,EAAOC,GAAR,OAAkBD,EAAMC,EAAMC,MAAQ,KACvDN,EAAkBN,EAAOM,iBAAmBO,iBAe5CC,EAAW,SAACC,GAAD,OAChB,SAAqBC,cACpB,OAAOV,GACN,SAACW,GAAD,OAAgBA,CADK,IAErB,SAACA,GAAD,OAAgBF,EAAMG,KAAKC,EAAMH,EAAQC,EAAzC,MAIGG,GAvFFZ,GAAQ,EACNC,EAAY,IAAIY,IACf,CACNC,IADM,SACFC,GACEf,EAGJe,EAAMC,SAAQ,SAACC,GAAD,OAAkBA,OAFhCF,EAAMC,SAAQ,SAACC,GAAD,OAAkBhB,EAAUa,IAAIG,KAH1C,EAQNC,OARM,SAQCD,GACNhB,EAAS,OAAQgB,EATZ,EAWNE,yBACCnB,GAAQ,EACRC,EAAUe,SAAQ,SAACC,GAAD,OAAkBA,MACpC,IAyEIG,EAzGN,SAASA,EACRC,EACAC,QAAA,IAAAA,IAAAA,EAA4BC,EAAAA,0BAE5B,IAAIC,EAAO,SAACtB,EAAYO,GAEvB,OADAe,EAAOF,EAA0BD,EAAqBD,KAC1ClB,EAAOO,IAGpB,OAAO,SAACP,EAAYO,GAAb,OAA4Be,EAAKtB,EAAOO,GAC/C,EAiGD,MAAO,CACNgB,QAAS,CACRL,OAAAA,EAEAxB,WAAAA,EACAE,gBAAAA,GAED4B,QAPM,SAOEvB,GAEPiB,EAAOjB,EAAMC,MAAQ,GAErB,IAAMuB,EACsB,mBAApBxB,EAAMyB,UAEVzB,EAAMyB,UAtCX,SAACzB,GAAD,OACA,SAAC0B,GACA,MAA2B,mBAAhBA,EACH/B,GACN,SAACI,GAAD,OACCN,EAAWM,EAAOC,EAFE,GAGrB0B,GAGKjC,EAAWiC,EAAa1B,IA6BX2B,CAAM3B,GAAQL,EAAiBQ,GAC/CH,EAAMyB,UAEVhB,EAAaE,IACZiB,OAAOC,KAAKL,GAAqB,IAAIM,KAAI,SAACC,IArErB,SACxBP,EACAO,EACA/B,GAEA,GAA6B,eAAzBV,QAAQC,IAAIC,UACkC,mBAAtCgC,MAAAA,OAAAA,EAAAA,EAAoBO,IAC9B,MAAM,IAAIrC,MACIM,aAAAA,EAAMC,KADd,IACsB8B,EAD5B,uBAKF,CA0DIC,CAAiBR,EAAmBO,EAAc/B,GAElD,IAAMc,EAAU,SAAVA,IAUL,OATAL,EAAaM,OAAOD,UAEbG,EAAOjB,EAAMC,MAAM8B,GAE1Bd,EAAOjB,EAAMC,MAAM8B,GAAgBP,EAClCO,GAECxB,KAAKU,EAAOjB,EAAMC,MAAOgB,GAEpBA,EAAOjB,EAAMC,MAAM8B,IAY3B,OAPAH,OAAOK,eAAehB,EAAOjB,EAAMC,MAAO8B,EAAc,CACvDG,cAAc,EACdC,eACC,OAAOrB,GACP,IAGKA,CAzBR,IAlBI,EA+CNsB,eA/CM,SA+CSC,GACd5B,EAAaO,gBAEbqB,EAAMpB,OAASA,CACf,EAEF"}